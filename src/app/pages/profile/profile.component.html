<div class="profile-content">
  <div class="page-header fade-in">
    <h1>Mi Perfil</h1>
    <p>Gestiona tu información personal</p>
  </div>

  <div class="profile-grid">
    <!-- Profile Info Card -->
    <mat-card class="profile-card fade-in">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>person</mat-icon>
          Información Personal
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="avatar-section">
          <div class="avatar">
            <mat-icon>person</mat-icon>
          </div>
          <button mat-stroked-button color="primary">
            <mat-icon>photo_camera</mat-icon>
            Cambiar foto
          </button>
        </div>

        <mat-divider></mat-divider>

        <form [formGroup]="profileForm" (ngSubmit)="onSaveProfile()">
          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Nombre</mat-label>
              <input matInput formControlName="nombre">
              <mat-icon matPrefix>badge</mat-icon>
              @if (profileForm.get('nombre')?.hasError('required') && profileForm.get('nombre')?.touched) {
                <mat-error>El nombre es requerido</mat-error>
              }
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Apellido</mat-label>
              <input matInput formControlName="apellido">
              <mat-icon matPrefix>badge</mat-icon>
              @if (profileForm.get('apellido')?.hasError('required') && profileForm.get('apellido')?.touched) {
                <mat-error>El apellido es requerido</mat-error>
              }
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline">
            <mat-label>Correo electrónico</mat-label>
            <input matInput type="email" formControlName="email">
            <mat-icon matPrefix>email</mat-icon>
            @if (profileForm.get('email')?.hasError('required') && profileForm.get('email')?.touched) {
              <mat-error>El correo es requerido</mat-error>
            }
            @if (profileForm.get('email')?.hasError('email') && profileForm.get('email')?.touched) {
              <mat-error>Ingresa un correo válido</mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Teléfono</mat-label>
            <input matInput formControlName="telefono">
            <mat-icon matPrefix>phone</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Dirección</mat-label>
            <textarea matInput formControlName="direccion" rows="2"></textarea>
            <mat-icon matPrefix>location_on</mat-icon>
          </mat-form-field>

          <div class="form-actions">
            <button mat-raised-button class="btn-primary" type="submit" [disabled]="profileForm.invalid">
              <mat-icon>save</mat-icon>
              Guardar Cambios
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>

    <!-- Password Card -->
    <mat-card class="password-card fade-in">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>lock</mat-icon>
          Cambiar Contraseña
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <form [formGroup]="passwordForm" (ngSubmit)="onChangePassword()">
          <mat-form-field appearance="outline">
            <mat-label>Contraseña actual</mat-label>
            <input matInput [type]="hideCurrentPassword ? 'password' : 'text'" formControlName="currentPassword">
            <mat-icon matPrefix>lock_outline</mat-icon>
            <button mat-icon-button matSuffix type="button" (click)="hideCurrentPassword = !hideCurrentPassword">
              <mat-icon>{{ hideCurrentPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            @if (passwordForm.get('currentPassword')?.hasError('required') && passwordForm.get('currentPassword')?.touched) {
              <mat-error>Ingresa tu contraseña actual</mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Nueva contraseña</mat-label>
            <input matInput [type]="hideNewPassword ? 'password' : 'text'" formControlName="newPassword">
            <mat-icon matPrefix>lock</mat-icon>
            <button mat-icon-button matSuffix type="button" (click)="hideNewPassword = !hideNewPassword">
              <mat-icon>{{ hideNewPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            @if (passwordForm.get('newPassword')?.hasError('required') && passwordForm.get('newPassword')?.touched) {
              <mat-error>Ingresa una nueva contraseña</mat-error>
            }
            @if (passwordForm.get('newPassword')?.hasError('minlength') && passwordForm.get('newPassword')?.touched) {
              <mat-error>Mínimo 6 caracteres</mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Confirmar nueva contraseña</mat-label>
            <input matInput [type]="hideConfirmPassword ? 'password' : 'text'" formControlName="confirmPassword">
            <mat-icon matPrefix>lock_reset</mat-icon>
            <button mat-icon-button matSuffix type="button" (click)="hideConfirmPassword = !hideConfirmPassword">
              <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            @if (passwordForm.get('confirmPassword')?.hasError('required') && passwordForm.get('confirmPassword')?.touched) {
              <mat-error>Confirma tu contraseña</mat-error>
            }
            @if (passwordForm.get('confirmPassword')?.hasError('passwordMismatch') && passwordForm.get('confirmPassword')?.touched) {
              <mat-error>Las contraseñas no coinciden</mat-error>
            }
          </mat-form-field>

          <div class="form-actions">
            <button mat-raised-button class="btn-secondary" type="submit" [disabled]="passwordForm.invalid">
              <mat-icon>vpn_key</mat-icon>
              Actualizar Contraseña
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>
